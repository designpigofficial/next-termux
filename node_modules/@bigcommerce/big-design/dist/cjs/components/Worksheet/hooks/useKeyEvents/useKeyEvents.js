"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useKeyEvents = void 0;

var _react = require("react");

var _useNavigation2 = require("../useNavigation");

var _useStore = require("../useStore");

var useKeyEvents = function useKeyEvents() {
  // Get the first cell of the selected values
  var selectedCell = (0, _useStore.useStore)((0, _react.useMemo)(function () {
    return function (state) {
      return state.selectedCells[0];
    };
  }, []));
  var isEditing = (0, _useStore.useStore)((0, _react.useMemo)(function () {
    return function (state) {
      return state.editingCell !== null;
    };
  }, []));
  var setEditingCell = (0, _useStore.useStore)(function (state) {
    return state.setEditingCell;
  });

  var _useNavigation = (0, _useNavigation2.useNavigation)(selectedCell),
      navigate = _useNavigation.navigate;

  var editSelectedCell = (0, _react.useCallback)(function () {
    if (selectedCell) {
      setEditingCell(selectedCell);
    }
  }, [selectedCell, setEditingCell]);
  var handleKeyDown = (0, _react.useCallback)(function (event) {
    var key = event.key;

    if (isEditing) {
      switch (key) {
        case 'Enter':
          navigate({
            rowIndex: 1,
            columnIndex: 0
          });
          break;

        case 'Tab':
          navigate({
            rowIndex: 0,
            columnIndex: event.shiftKey ? -1 : 1
          });
          break;
      }
    } else {
      switch (key) {
        case 'Enter':
          if (selectedCell && !selectedCell.disabled) {
            editSelectedCell();

            if (selectedCell.type === 'checkbox') {
              navigate({
                rowIndex: 1,
                columnIndex: 0
              });
            }
          }

          break;

        case ' ':
          if (selectedCell && !selectedCell.disabled) {
            editSelectedCell();
          }

          break;

        case 'ArrowUp':
          navigate({
            rowIndex: -1,
            columnIndex: 0
          });
          break;

        case 'ArrowDown':
          navigate({
            rowIndex: 1,
            columnIndex: 0
          });
          break;

        case 'ArrowRight':
          navigate({
            rowIndex: 0,
            columnIndex: 1
          });
          break;

        case 'Tab':
          navigate({
            rowIndex: 0,
            columnIndex: event.shiftKey ? -1 : 1
          });
          break;

        case 'ArrowLeft':
          navigate({
            rowIndex: 0,
            columnIndex: -1
          });
          break;
      }

      event.preventDefault();
    }
  }, [editSelectedCell, isEditing, navigate, selectedCell]);
  return (0, _react.useMemo)(function () {
    return {
      handleKeyDown: handleKeyDown
    };
  }, [handleKeyDown]);
};

exports.useKeyEvents = useKeyEvents;